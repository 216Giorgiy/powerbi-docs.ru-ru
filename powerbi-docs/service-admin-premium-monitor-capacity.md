---
title: Мониторинг емкостей Power BI Premium в вашей организации
description: Использование портала администрирования Power BI и приложения Power BI Premium Capacity Metrics
author: mgblythe
ms.author: mblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.component: powerbi-admin
ms.topic: conceptual
ms.date: 10/09/2018
LocalizationGroup: Premium
ms.openlocfilehash: 2623dd3280636583d5dd6d6e3f57518550032193
ms.sourcegitcommit: 42475ac398358d2725f98228247b78aedb8cbc4f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50003209"
---
# <a name="monitor-power-bi-premium-and-power-bi-embedded-capacities"></a>Мониторинг емкостей Power BI Premium и Power BI Embedded

В этой статье представлен обзор мониторинга метрик емкостей Power BI Premium. Мониторинг емкостей позволяет вам применять обоснованный подход к управлению возможностями.

Вы можете контролировать емкость с помощью приложения Power BI Premium Capacity Metrics или на портале администрирования. Мы рекомендуем приложение, потому что оно предоставляет гораздо больше деталей, но в этой статье рассматриваются оба варианта.

<iframe width="560" height="315" src="https://www.youtube.com/embed/UgsjMbhi_Bk?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>

## <a name="install-the-premium-capacity-metrics-app"></a>Установка приложения Power BI Premium Capacity Metrics

Вы можете перейти к [приложению Premium Capacity Metrics](https://app.powerbi.com/groups/me/getapps/services/capacitymetrics) или установить его так же, как и другие приложения в Power BI.

1. В Power BI щелкните **Приложения**.

    ![Переход к приложениям](media/service-admin-premium-monitor-capacity/apps.png)

2. Справа щелкните **Получить приложения**.

3. В категории **Приложения** найдите приложение **Power BI Premium Capacity Metrics**.

4. Подпишитесь, чтобы установить приложение.

Теперь, когда вы установили приложение, вы можете увидеть метрики емкости своей организации. Давайте посмотрим на некоторые из доступных ключевых метрик.

## <a name="use-the-metrics-app"></a>Использование приложения метрик

Когда вы открываете приложение, в нем сначала отображается информационная панель с кратким описанием всех возможностей, для которых у вас есть права администратора.

![Панель мониторинга приложения метрики](media/service-admin-premium-monitor-capacity/app-dashboard.png)

Отчет содержит три вкладки, которые будут более подробно описаны в следующих разделах.

* **Фильтры, применяемые ко всем страницам**: позволяет отфильтровать другие страницы отчета по определенной емкости.
* **Наборы данных**: обеспечивает подробные метрики о работоспособности наборов данных в емкости.
* **Система**: предоставляет общие метрики емкости, включая память и высокую загрузку ЦП. 

### <a name="filters-applied-to-all-pages-tab"></a>Вкладка "Фильтры, применяемые ко всем страницам"

Вкладка **Фильтры, применяемые ко всем страницам**, позволяют вам выбрать емкость, набор данных и диапазон дат за последние семь дней. Фильтры затем применяются ко всем соответствующим страницам и фрагментам отчета. Если фильтры выбрано, по умолчанию для отчета будут отображаться метрики прошлой недели по каждой вашей емкости.

![вкладка "Фильтры"](media/service-admin-premium-monitor-capacity/filters-tab.png)

### <a name="datasets-tab"></a>вкладка "Наборы данных"

Вкладка **Наборы данных** обеспечивает большую часть метрик приложения. Используйте кнопки в верхней части вкладки, чтобы переходить по областям: **Summary** (Сводка), **Refreshes** (Обновления), **Query Durations** (Длительность запросов), **Query Waits** (Ожидания запросов) и **Datasets** (Наборы данных).

![вкладка "Наборы данных"](media/service-admin-premium-monitor-capacity/datasets-tab.png)

#### <a name="summary-area"></a>область "Сводка"

Область **Сводка** отображает представление ваших емкостей на основе сущностей, системных ресурсов и рабочих нагрузок набора данных.

| | **Метрики** |
| --- | --- |
| **Сущности** | * Количество имеющихся у вас емкостей<br> * Конкретное количество наборов данных в вашей емкости<br> * Конкретное количество рабочих областей в вашей емкости |
| **Система** | * Среднее использование памяти в ГБ за последние семь дней<br> * Наибольший объем потребления памяти в ГБ за последние семь дней по местному времени<br> * Количество ЦП, на которых за последние семь дней превышено 80 % пороговых значений нагрузки, разделенных на контейнеры по три минуты<br> * Наибольшее количество случаев, когда уровень нагрузки ЦП был выше 80 % за последние семь дней, разделенных на контейнеры по часу, и местное время для каждого события<br> * Количество раз, когда прямой запрос или запросы на динамическое подключение превысили 80 % пороговых значений за последние семь дней, разделенных на контейнеры по три минуты<br> * Наибольшее количество случаев, когда прямой запрос или запросы на динамические подключение превысили 80 % пороговых значений за последние семь дней, разделенных на контейнеры по часу, и местное время каждого события |
| **Рабочие нагрузки наборов данных** | * Общее количество обновлений за последние семь дней<br> * Общее количество успешных обновлений за последние семь дней<br> * Общее количество обновлений, завершившихся сбоем, за последние семь дней<br> * Общее количество обновлений, завершившихся сбоем из-за нехватки памяти<br> * Средняя продолжительность обновления в минутах и время выполнения операции<br> * Среднее время ожидания обновления в минутах, среднее отставание между запланированным временем и началом операции<br> * Общее количество запросов за последние семь дней<br> * Общее количество успешных запросов за последние семь дней<br> * Общее количество запросов, завершившихся сбоем, за последние семь дней<br> * Средняя продолжительность запроса в минутах, время, необходимое для завершения операции<br> * Общее количество моделей, исключенных из-за нехватки памяти |
|  |  |

#### <a name="refreshes-area"></a>область "Обновления"

В области **Обновления** перечислены все обновления, показатели успешных выполнений, среднее и максимальное время ожидания и обновления в виде срезов по наборам данных за последние семь дней. На двух диаграммах ниже показано сравнение числа обновлений и потребления памяти в ГБ, а также среднее время ожидания по местному времени, разделенное на контейнеры по одному часу. В верхних линейчатых диаграммах содержится список первых пяти наборов данных с общей суммой среднего времени, необходимого для обновления набора данных (время обновления) и среднего ожидания времени обновления. Множественные всплески ожидания с высокой частотой обновления показывают, что емкость перегружена.

#### <a name="query-durations-area"></a>Область длительности запросов

Область **Query Durations** (Длительность запросов) демонстрирует общее число выполненных запросов, а также среднее и максимальное значение длительности выполнения в миллисекундах. Эти данные группируются по наборам данных, рабочим областям и периодам длительностью в один час за последние семь дней. На нижней диаграмме указано количество запросов и средняя длительность их выполнения (в миллисекундах) в сравнении с потреблением памяти (в ГБ) с разбивкой на периоды в один час, которые определяются по местному времени.

На диаграмме справа в верхней части вкладки отображается гистограмма с распределением запросов по длительности. Данные для этой гистограммы группируются по длительности запросов в миллисекундах по следующим категориям: ≤ 30 мс, от 30 до 100 мс, от 100 до 300 мс, от 300 мс до 1 сек, от 1 до 3 сек, от 3 до 10 сек, от 10 до 30 сек, больше 30 секунд.

На диаграмме в нижней части справа перечислены пять наборов данных, к которым выполняются запросы с наибольшим средним значением длительности.

Длительные запросы и длительное время ожидания указывают на горячий уровень хранилища емкости. Это может также означать, что один набор данных вызывает проблемы и требует дальнейшего изучения.

#### <a name="query-waits-area"></a>Область Query Waits (Ожидания запросов)

В области **Query Waits** (Ожидания запросов) указано общее количество выполненных запросов, общее количество ожиданий для активных и прямых запросов, а также средняя и максимальная продолжительность ожидания в миллисекундах. Эти данные группируются по наборам данных, рабочим областям и периодам длительностью в один час за последние семь дней. На нижней диаграмме указано количество ожиданий запросов и средняя длительность ожидания (в миллисекундах) в сравнении с потреблением памяти (в ГБ) с разбивкой на периоды в один час, которые определяются по местному времени.

На диаграмме справа в верхней части вкладки отображается гистограмма с распределением запросов по длительности ожидания. Данные для этой гистограммы группируются в зависимости от длительности периодов ожидания в миллисекундах по следующим категориям: ≤ 50 мс, от 50 до 100 мс, от 100 до 200 мс, от 200 до 400 мс, от 400 мс до 1 сек, от 1 до 5 сек, больше 5 секунд.

На диаграмме в нижней части справа перечислены пять наборов данных, к которым выполняются запросы с наибольшим средним значением длительности ожидания.

#### <a name="datasets-area"></a>область "Наборы данных"

В области **Наборы данных** показаны полные наборы данных, исключенные из-за нехватки памяти по часам.

### <a name="system-tab"></a>Вкладка System (Система)

На вкладке **Система** показано высокое время загрузки ЦП (сколько раз нагрузка была выше 80 %), высокий уровень загрузки для прямого запроса или запроса на динамическое подключение, и данные о потреблении памяти.

![Отчет по системным сведениям о емкости Premium](media/service-admin-premium-monitor-capacity/system-tab.png)

## <a name="monitor-power-bi-embedded-capacity"></a>Мониторинг емкости Power BI Embedded

Вы также можете использовать приложение Power Capacity Premium Capacity Metrics для мониторинга емкостей *SKU A* в Power BI Embedded. Эти емкости появятся в отчете, если вы являетесь администратором емкости. Однако обновление отчета не выполняется, если вы не предоставите определенные разрешения для Power BI в своих номерах SKU A:

1. Откройте емкость на портале Azure.
1. Щелкните **Управление доступом (IAM)** и добавьте приложение Power BI Premium к роли читателя. Если вы не можете найти приложение по имени, вы также можете добавить его по его идентификатору: cb4dc29f-0bf4-402a-8b30-7511498ed654.

    ![Разрешения для Power BI Embedded](media/service-admin-premium-monitor-capacity/embedded-permissions.png)

> [!NOTE]
> Вы можете контролировать потребление емкости Power BI Embedded в приложении или на портале Azure, но не на портале администрирования Power BI.

## <a name="basic-monitoring-in-the-admin-portal"></a>Базовый мониторинг на портале администрирования

В области **Параметры емкости** на портале администрирования имеется четыре датчика, которые указывают нагрузку и ресурсы, использованные вашей емкостью за последние семь дней. Эти четыре элемента работают в почасовом временном окне, что указывает, сколько часов за последние семь дней соответствующая метрика была выше 80 %. Эта метрика указывает на потенциальное снижение производительности для пользователей.

![Использование в течение 7 дней](media/service-admin-premium-monitor-capacity/usage-in-days.png)

| **Метрика** | **Описание** |
| --- | --- |
| ЦП |Число раз, когда загрузка ЦП превысила 80 %. |
| Пробуксовка памяти |Нехватка памяти в ядрах серверной части. В частности, это метрика показывает, сколько раз наборы данных вытесняются из памяти из-за нехватки памяти в результате использования нескольких наборов данных. |
| Использование памяти |Средний уровень использования памяти в гигабайтах (ГБ). |
| Прямых запросов в секунду | Число раз, когда количество прямых запросов и активных подключений превысило 80 % от максимального. <br> * Мы ограничиваем общее количество запросов DirectQuery и активных запросов на подключение в секунду.* Пределы составляют 30/с для P1, 60/с для P2 и 120/с для P3. * При учете указанного выше ограничения число прямых запросов и запросов активных подключений складывается. Например, при наличии 15 прямых запросов и 15 запросов на динамическое подключение в секунду будет достигнут лимит регулирования.<br>* Это в равной степени относится к локальным и облачным подключениям. |
|  |  |

Метрики отражают использование за последнюю неделю.  Чтобы изучить метрики более подробно, можно щелкнуть одну из плиток сводки.  В результате открываются подробные диаграммы для каждой из метрик, связанных с емкостью Premium. На следующей диаграмме показаны подробные метрики ЦП.

![Подробная диаграмма по загрузке ЦП](media/service-admin-premium-monitor-capacity/premium-usage-detailed-chart-cpu.png)

На диаграммах представлены сводные данные за последнюю неделю, которые обновляются каждый час. Это позволяет определить, когда произошли те или иные события, связанные с производительностью емкости Premium.

Базовые данные любой из метрик можно также экспортировать в CSV-файл.  Он будет содержать подробные сведения за каждый день последней недели с трехминутным интервалом.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы понимаете, как выполнять мониторинг емкостей Power BI Premium, узнайте больше об их оптимизации.

> [!div class="nextstepaction"]
> [Использование и оптимизация ресурсов емкости Power BI Premium](service-premium-understand-how-it-works.md)
