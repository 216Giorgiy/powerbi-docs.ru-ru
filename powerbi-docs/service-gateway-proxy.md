---
title: "Настройка параметров прокси-сервера для локального шлюза данных"
description: "Сведения о настройке параметров прокси-сервера для локального шлюза данных."
services: powerbi
documentationcenter: 
author: davidiseminger
manager: kfile
backup: 
editor: 
tags: 
qualityfocus: no
qualitydate: 
ms.service: powerbi
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: powerbi
ms.date: 09/06/2017
ms.author: davidi
ms.openlocfilehash: 6fb6250f8cd82c7057abe3f9cf9792dc733ea4b6
ms.sourcegitcommit: 284b09d579d601e754a05fba2a4025723724f8eb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2017
---
# <a name="configuring-proxy-settings-for-the-on-premises-data-gateway"></a>Настройка параметров прокси-сервера для локального шлюза данных
Рабочие среды могут требовать, чтобы доступ в Интернет осуществлялся через прокси-сервер. Это может помешать локальному шлюзу данных подключаться к службе.

## <a name="does-your-network-use-a-proxy"></a>Используется ли прокси-сервер в вашей сети?
В приведенной ниже публикации на сайте superuser.com описано, как попытаться определить наличие прокси-сервера в сети.

[Как узнать, какой прокси-сервер используется? (SuperUser.com)](https://superuser.com/questions/346372/how-do-i-know-what-proxy-server-im-using)

## <a name="configuration-file-location-and-default-configuration"></a>Расположение файла конфигурации и конфигурация по умолчанию
Сведения о прокси-сервере настраиваются в файле конфигурации платформы .NET. Расположение и имена файлов зависят от используемого шлюза.

### <a name="on-premises-data-gateway"></a>Локальный шлюз данных
Локальный шлюз данных использует два основных файла конфигурации.

**Конфигурация**

Первый предназначен для экранов конфигурации, используемых непосредственно для настройки шлюза. Если возникают проблемы при настройке шлюза, обратитесь именно к этому файлу.

    C:\Program Files\On-premises data gateway\enterprisegatewayconfigurator.exe.config

**Служба Windows**

Второй служит для фактической службы Windows, которая взаимодействует со службой Power BI и обрабатывает запросы.

    C:\Program Files\On-premises data gateway\Microsoft.PowerBI.EnterpriseGateway.exe.config

### <a name="power-bi-gateway---personal"></a>Шлюз Power BI — персональный
> [!NOTE]
> Имеется новая версия личного шлюза для Power BI, которая называется **локальным шлюзом данных (персональный режим)**. В этом разделе статьи описывается предыдущая версия личного шлюза (**Power BI Gateway - Personal**), использование которой будет прекращено и которая перестанет работать после 31 июля 2017 года. Сведения о новой версии личного шлюза, в том числе об установке новой версии, см. в статье [**Локальный шлюз данных (персональный режим)**](service-gateway-personal-mode.md).
> 
> 

Личный шлюз можно установить одним из двух способов. Как службу Windows (администратор) или как приложение пользовательского режима. Это определяется во время установки. В результате файлы конфигурации могут находиться в одном из двух расположений в зависимости от способа установки шлюза. Рекомендуется проверить оба этих расположения.

**Конфигурация**

Первый предназначен для экранов конфигурации, используемых непосредственно для настройки шлюза. Если возникают проблемы при настройке шлюза, обратитесь именно к этому файлу.

Для *службы Windows* используются следующие пути:

    C:\Program Files\Power BI Personal Gateway\1.0\Configurator\GWConfig.exe.config
    C:\Program Files\Power BI Personal Gateway\1.0\Configurator\PowerBIGatewayAgentCmdLine.exe.config

Для *приложения пользовательского режима* используются следующие пути:

    C:\Users\<user>\AppData\Local\Power BI Gateway - Personal \1.0\Configurator\GWConfig.exe.config
    C:\Users\<user>\AppData\Local\Power BI Gateway - Personal \1.0\Configurator\PowerBIGatewayAgentCmdLine.exe.config

**Служба Windows**

Второй служит для фактической службы Windows, которая взаимодействует со службой Power BI и обрабатывает запросы.

Для *службы Windows* используются следующие пути:

    C:\Program Files\Power BI Personal Gateway\1.0\Gateway\diawp.exe.config

Для *приложения пользовательского режима* используются следующие пути:

    C:\Users\<user>\AppData\Local\Power BI Gateway - Personal \1.0\Gateway\diawp.exe.config

## <a name="configuring-proxy-settings"></a>Настройка параметров прокси-сервера
По умолчанию для прокси-сервера используется следующая конфигурация:

    <system.net>
        <defaultProxy useDefaultCredentials="true" />
    </system.net>

В конфигурации по умолчанию применяется проверка подлинности Windows. Если прокси-сервер использует другую форму проверки подлинности, необходимо изменить параметры. Если вы не уверены, что именно следует сделать, обратитесь к администратору сети.

Дополнительные сведения о настройке элементов прокси-сервера в файлах конфигурации .NET см. в статье [Элемент defaultProxy (параметры сети)](https://msdn.microsoft.com/library/kd3cf2ex.aspx)

## <a name="changing-the-gateway-service-account-to-a-domain-user"></a>Смена учетной записи службы шлюза на пользователя домена
Если при настройке параметров прокси-сервера вы указали учетные данные по умолчанию, как описано выше, могут возникнуть проблемы с проверкой подлинности. Это связано с тем, что учетная запись службы по умолчанию представляет собой идентификатор безопасности службы, а не прошедшего проверку подлинности пользователя домена. Чтобы настроить правильную проверку подлинности на прокси-сервере, вы можете сменить учетную запись службы шлюза.

> [!NOTE]
> Чтобы избежать необходимости сбрасывать пароли, рекомендуется использовать управляемую учетную запись службы. Узнайте, как создать [управляемую учетную запись службы](https://technet.microsoft.com/library/dd548356.aspx) в Active Directory.
> 
> 

### <a name="change-the-on-premises-data-gateway-service-account"></a>Изменение учетной записи службы локального шлюза данных
1. Сведения о том, как изменить учетную запись службы Windows для **локального шлюза данных**.
   
    По умолчанию в качестве учетной записи для этой службы используется *NT SERVICE\PBIEgwService*. Ее рекомендуется заменить учетной записью пользователя домена Active Directory. Кроме того, чтобы избежать необходимости менять пароль, можно воспользоваться управляемой учетной записью службы.
   
    Учетная запись меняется на вкладке **Вход** в свойствах службы Windows.
2. Перезапустите **службу локального шлюза данных**.
   
    Выполните следующую команду в окне командной строки администратора.
   
        net stop PBIEgwService
   
        net start PBIEgwService
3. Запустите **средство настройки локального шлюза данных**. Вы можете нажать кнопку пуска Windows и выполнить поиск по запросу *Локальный шлюз данных*.
4. Войдите в Power BI.
5. Восстановите шлюз с помощью ключа восстановления.
   
    В результате новая учетная запись службы сможет расшифровать учетные данные, сохраненные для источников данных.

## <a name="next-steps"></a>Дальнейшие действия
[Локальный шлюз данных (персональный режим)](service-gateway-personal-mode.md)
[Сведения о брандмауэре](service-gateway-onprem-tshoot.md#firewall-or-proxy)  
Появились дополнительные вопросы? [Ответы на них см. в сообществе Power BI.](http://community.powerbi.com/)

