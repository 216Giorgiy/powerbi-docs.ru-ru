## <a name="general"></a>Общие
**Вопрос.** Как называется фактически используемая служба Windows?  
**Ответ.** В списке служб шлюз указан под именем On-premises data gateway (локальный шлюз данных).

**Вопрос.** Каковы требования для использования шлюза?  
**Ответ.** Ознакомьтесь с разделом требований в [основной статье о шлюзах](../service-gateway-onprem.md).

**Вопрос.** Какие источники данных поддерживает шлюз?  
**Ответ.** Ознакомьтесь с таблицей источников данных в [основной статье о шлюзах](../service-gateway-onprem.md).

**Вопрос.** Нужен ли шлюз для облачных источников данных, таких как Azure SQL Database?  
**Ответ.** Нет. Служба подключается к таким источникам без шлюза.

**Вопрос.** Существуют ли входящие подключения к шлюзу из облака?  
**Ответ.** Нет. Шлюз устанавливает исходящие подключения к служебной шине Azure.

**Вопрос.** Что делать, если заблокированы исходящие подключения? Что именно мне нужно открыть?  
**Ответ.** См. [список портов](../service-gateway-onprem.md#ports) и узлов, которые использует шлюз.

**Вопрос.** Шлюз обязательно должен быть установлен на том же компьютере, что и источник данных?  
**Ответ.** Нет. Шлюз устанавливает соединение с источником с помощью указанных сведений о подключении. В этом смысле он работает как клиентское приложение. Ему просто необходима возможность подключаться к серверу с указанным именем.

**Вопрос.** Какова задержка при выполнении запросов от шлюза к источнику данных? Какова оптимальная архитектура?  
**Ответ.** Чтобы уменьшить задержку в сети, рекомендуется размещать шлюз как можно ближе к источнику данных. Если вам удастся установить шлюз на компьютере с источником, задержка будет минимальной. Обращайте внимание и на расположение центров данных. Например, если ваша служба использует определенный центр данных, а ваш сервер SQL Server работает на виртуальной машине Azure, эту виртуальную машину также следует разместить в этом центре. Это позволит минимизировать задержку и исходящий трафик для виртуальной машины Azure.

**Вопрос.** Существуют ли требования к пропускной способности сети?  
**Ответ.** Для подключения к сети рекомендуется обеспечить высокую пропускную способность. У каждой среды свои особенности, и требования к пропускной способности также зависят от объема пересылаемых данных. Чтобы обеспечить определенную пропускную способность между локальной системой и центрами данных Azure, вы можете использовать ExpressRoute.

Измерить пропускную способность можно с помощью стороннего [приложения для проверки скорости Azure Speed Test](http://azurespeedtest.azurewebsites.net/).

**Вопрос.** Может ли служба шлюза Windows работать с учетной записью Azure Active Directory?  
**Ответ.** Нет. Службе Windows необходима действительная учетная запись Windows. По умолчанию она использует ИД безопасности службы *NT SERVICE\PBIEgwService*.

**Вопрос.** Каким образом результаты передаются обратно в облако?  
**Ответ.** Для этого используется служебная шина Azure. Вы можете ознакомиться с [принципами ее работы](../service-gateway-onprem.md#how-the-gateway-works).

**Вопрос.** Где хранятся мои учетные данные?  
**Ответ.** Учетные данные, указанные вами для источника данных, хранятся в зашифрованном виде в облачной службе шлюза. Они расшифровываются на локальном шлюзе.

**Вопрос.** Можно ли поместить шлюз в сеть периметра (которая также называется DMZ, демилитаризованной зоной или промежуточной подсетью)?  
**Ответ.** Шлюзу необходимо подключение к источнику данных. Если источник недоступен в сети периметра, у шлюза могут возникнуть проблемы с подключением к нему. Например, сервер SQL Server может располагаться за пределами сети периметра и подключиться к нему из нее невозможно. Если ваш шлюз находится в этой сети, он не сможет установить соединение с сервером SQL Server.

**Вопрос.** Можно ли настроить принудительное использование со служебной шиной Azure HTTPS-трафика, а не TCP-трафика?  
**Ответ.** Да. Однако это приведет к значительному снижению производительности. Необходимо изменить файл *Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config*. Требуется изменить значение `AutoDetect` на `Https`. По умолчанию этот файл находится в каталоге *C:\Program Files\On-premises data gateway*.

**Вопрос.** Нужно ли добавлять список IP-адресов центров данных Azure в список разрешений, и где можно получить список этих адресов?  
**Ответ.** Если вы блокируете исходящий IP-трафик, список IP-адресов центров данных Azure, возможно, потребуется добавить в список разрешений. Сейчас шлюз взаимодействует со служебной шиной Azure, используя и IP-адрес, и полное доменное имя. Список IP-адресов центров данных Azure обновляется еженедельно. Вы можете скачать [список IP-адресов центров данных Microsoft Azure](https://www.microsoft.com/download/details.aspx?id=41653).

```xml
<setting name="ServiceBusSystemConnectivityModeString" serializeAs="String">
    <value>Https</value>
</setting>
```

## <a name="high-availabilitydisaster-recovery"></a>Высокая доступность и аварийное восстановление
**Вопрос.** Планируется ли включение сценариев высокой доступности в шлюзе?  
**Ответ.** Да, команда Power BI активно работает над этим. Следите за обновлениями в [блоге по Power BI](https://powerbi.microsoft.com/blog/) для получения дополнительных сведений об этой функции.

**Вопрос.** Какие варианты аварийного восстановления доступны?  
**Ответ.** Для восстановления или переноса шлюза можно использовать ключ восстановления. Он задается при установке шлюза.

**Вопрос.** В чем преимущества ключа восстановления?  
**Ответ.** Ключ восстановления позволяет перенести или восстановить параметры шлюза. Кроме того, он используется для аварийного восстановления.

## <a name="troubleshooting"></a>Устранение неполадок
**Вопрос.** Где находятся журналы шлюза?  
**Ответ.** См. раздел [статьи об устранении неполадок](../service-gateway-onprem-tshoot.md#tools-for-troubleshooting), посвященный инструментам и средствам.

**Вопрос.** Как узнать, какие запросы отправляются в локальный источник данных?  
**Ответ.** Можно включить отслеживание запросов.  При этом фиксируются и отправляемые запросы. Не забудьте отключить эту функцию, когда завершите устранение неполадок. Когда отслеживание запросов включено, журналы становятся больше.

Вы также можете воспользоваться инструментами для отслеживания запросов, которые предусмотрены для вашего источника данных. Например, для сервера SQL Server и служб Analysis Services можно использовать функцию "Расширенные события" или приложение SQL Profiler.

