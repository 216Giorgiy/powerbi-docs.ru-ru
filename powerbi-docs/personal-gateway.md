---
title: Шлюз Power BI — персональный
description: Шлюз Power BI — персональный
services: powerbi
documentationcenter: ''
author: mgblythe
manager: kfile
backup: ''
editor: ''
tags: ''
qualityfocus: no
qualitydate: ''
ms.service: powerbi
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: powerbi
ms.date: 12/06/2017
ms.author: mblythe
LocalizationGroup: Gateways
ms.openlocfilehash: 8d047e814eaa7c84ee7e1be20d1f4722c6cb1e56
ms.sourcegitcommit: c80fbf5b12754ce217cb47a17cb5400b1036a8f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
# <a name="power-bi-gateway---personal"></a>Шлюз Power BI — персональный
> [!NOTE]
> Реализована новая версия личного шлюза для Power BI, которая называется **локальным шлюзом данных (персональный режим)**. В следующей статье описывается предыдущая версия личного шлюза (**Power BI Gateway - Personal**), использование которой будет прекращено и которая перестанет работать после 31 июля 2017 года. Сведения о новой версии личного шлюза, в том числе об установке новой версии, см. в статье [**Локальный шлюз данных (персональный режим)**](service-gateway-personal-mode.md).
> 
> 

Шлюз **Power BI Gateway — Personal** действует в качестве моста, обеспечивая быструю и безопасную передачу данных между службой Power BI и локальными источниками данных, поддерживающими [обновление](refresh-data.md). Эта статья позволяет получить полное представление о принципах работы шлюза и определить его необходимость. Мы также предлагаем вашему вниманию [полезное видео](https://www.youtube.com/watch?v=de58vROLqZI) о личном шлюзе. 

Он устанавливается и запускается на компьютере в качестве службы. Как служба он выполняется под учетной записью Windows, заданной во время настройки. В некоторых случаях шлюз работает как приложение. Этот момент будет рассмотрен позднее.

Когда Power BI обновляет данные из локального источника данных, шлюз гарантирует, что учетная запись Power BI имеет нужные разрешения для подключения к источнику и запросу из него данных.

Передача данных между Power BI и шлюзом защищена с помощью [служебной шины Azure](http://azure.microsoft.com/documentation/services/service-bus/). Служебная шина создает безопасный канал между службой Power BI и компьютером. Так как шлюз обеспечивает такое безопасное подключение, как правило, открывать порт в брандмауэре не требуется.

Прежде чем рассмотреть шлюз более подробно, обратимся к некоторым терминам, используемым в Power BI.

*Набор данных* — это данные, переданные в службу Power BI из сетевого или локального источника данных. Набор данных создается при использовании функции получения данных для подключения и отправки данных. Наборы данных отображаются в области "Мои представления" рабочей области Power BI в браузере. При создании отчетов и прикреплении файлов к информационным панелям вы просматриваете данные из наборов данных.

*Источник данных* — это место происхождения данных, отправленных в набор данных. Им может быть практически что угодно: база данных, таблица Excel, веб-служба и т. д. Используя книги Excel, можно создать простую таблицу со строками данных, которая будет считаться источником данных. В одной и той же книге можно также использовать Power Query и Power Pivot в Excel для подключения и запроса данных из сетевых и локальных источников. При использовании Power BI Desktop можно использовать функцию получения данных для подключения и запроса данных из сетевых и локальных источников данных.

Личный шлюз устанавливается через локальный шлюз данных. Его можно загрузить на [странице Power BI Gateway](https://powerbi.microsoft.com/gateway/).

## <a name="do-i-need-a-gateway"></a>Когда требуется использовать шлюз?
Прежде чем установить шлюз, важно определить, требуется ли он на самом деле. Это зависит от источников данных.

### <a name="on-premises-data-sources"></a>Локальные источники данных
Личный шлюз *требуется* для обновления наборов данных, получающих данные из поддерживаемого локального источника данных в организации.

При наличии шлюза функции "ОБНОВИТЬ СЕЙЧАС" и "РАСПИСАНИЕ ОБНОВЛЕНИЙ" поддерживаются для наборов данных, отправленных из следующих источников.

* Книги Microsoft Excel 2013 (или более поздние версии), где Power Query или Power Pivot используются для подключения и запроса данных из поддерживаемого локального источника данных. Все локальные источники данных, отображаемые в разделе "Получение внешних данных" в Power Query и Power Pivot, поддерживают обновления, кроме файла Hadoop (HDFS) и Microsoft Exchange.
* Файлы Microsoft Power BI Desktop, где функция "Получить данные" используется для подключения и запроса данных из поддерживаемого локального источника данных. Все локальные источники данных, отображаемые в разделе "Получение данных", поддерживают обновления, кроме файла Hadoop (HDFS) и Microsoft Exchange.

### <a name="online-data-sources"></a>Сетевые источники данных
Шлюз *нужен только в том случае*, если вы используете функцию [**Web.Page**](https://msdn.microsoft.com/library/mt260924.aspx). В остальных случаях шлюз *не нужен* для обновления наборов данных, получающих данные только из подключенного к сети источника данных.

> [!NOTE]
> Если вы используете функцию [**Web.Page**](https://msdn.microsoft.com/library/mt260924.aspx) и повторно опубликовали набор данных или отчет после 18 ноября 2016 г., вам потребуется шлюз.
> 
> 

Функции "ОБНОВИТЬ СЕЙЧАС" и "РАСПИСАНИЕ ОБНОВЛЕНИЙ" поддерживаются без шлюза для наборов данных, отправленных из следующих источников.

* Пакеты содержимого из подключенных к сети источников данных (пакеты содержимого или \\службы). По умолчанию наборы данных из пакетов содержимого автоматически обновляются раз в день. Однако можно также выполнить обновление вручную или настроить расписание обновления.
* Книги Microsoft Excel 2013 (или более поздние версии), где Power Query или Power Pivot используются для подключения и запроса данных из сетевого источника данных.
* Файлы Microsoft Power BI Desktop, где функция "Получить данные" используется для подключения и запроса данных из сетевого источника данных.

**Вопрос.** Что если книга Excel или файл Power BI Desktop получают данные как из сетевого, так и из локального источников данных?

**Ответ.** Шлюз *требуется*. Необходимо установить и настроить шлюз, чтобы обновлять данные из локальных источников данных.

**Вопрос.** Что если в книге Excel находятся только строки введенных данных?**

**Ответ.** Шлюз *не требуется*. Необходимо установить и настроить шлюз, если в книге используются Power Query или Power Pivot для запроса и загрузки данных в модель данных из поддерживаемого локального источника данных.

## <a name="setting-up-a-gateway-for-the-first-time"></a>Настройка шлюза в первый раз
В первый раз настройка шлюза выполняется в три этапа.

1. Скачивание и установка шлюза
2. Настройка шлюза
3. Вход в источники данных в Power BI

Давайте рассмотрим каждый шаг более подробно.

### <a name="download-and-install-a-gateway"></a>Скачивание и установка шлюза
> [!NOTE]
> Имеется новая версия личного шлюза для Power BI, которая называется **локальным шлюзом данных (персональный режим)**. В этой статье описывается предыдущая версия личного шлюза (**Power BI Gateway - Personal**), использование которой будет прекращено и которая перестанет работать после 31 июля 2017 года. Сведения о новой версии личного шлюза, в том числе об установке новой версии, см. в статье [**Локальный шлюз данных (персональный режим)**](service-gateway-personal-mode.md).
> 
> 

При первом выборе параметров "ОБНОВИТЬ СЕЙЧАС" и "РАСПИСАНИЕ ОБНОВЛЕНИЙ" для поддерживаемого набора вам будет предложено установить шлюз. Чтобы скачать шлюз, выберите **Шлюз данных** в меню "Загрузки". Скачайте [локальный шлюз данных](http://go.microsoft.com/fwlink/?LinkID=820925).

Чтобы скачать шлюз, предназначенный для вас, вместо варианта **Локальный шлюз данных** выберите **Личный шлюз**.

Для установки шлюза требуется выполнить лишь несколько действий. Нужно выбрать расположение для установки, прочитать и принять условия лицензионного соглашения, как это делается для любого другого приложения. Однако необходимо знать некоторые важные моменты. В частности, тип компьютера, на который устанавливается шлюз, и тип учетной записи, с помощью которой выполнен вход в Windows на этом компьютере.

> [!NOTE]
> Шлюз должен иметь доступ к источнику данных. Если персональный компьютер не может подключиться к источнику данных, рассмотрите возможность установки [локального шлюза данных](service-gateway-onprem.md) на таком компьютере. Примером такого случая может служить решение SQL Server, установленное на виртуальной машине, размещенной в Azure. Возможно, ваш персональный компьютер не имеет доступа к виртуальной машине. В качестве альтернативы можно установить локальный шлюз данных на виртуальной машине и настроить источник данных в службе Power BI.
> 
> 

### <a name="computer-type"></a>Тип компьютера
Тип компьютера для установки шлюза имеет важное значение.

> [!NOTE]
> Личный шлюз поддерживается только в 64-разрядных операционных системах Windows.
> 
> 

Чтобы выполнить запланированное обновление на ноутбуке, шлюз должен быть запущен и находиться в рабочем состоянии. Как правило, ноутбуки завершают работу или находятся в спящем режиме больше времени, чем в рабочем. При установке шлюза на ноутбук необходимо задать запланированное обновление на время, когда устройство будет работать. В противном случае обновление будет выполнено только при наступлении времени следующего запланированного обновления.

На настольном компьютере возникает не так много проблем. Просто убедитесь, что во время запланированного обновления компьютер и шлюз запущены и работают. Многие настольные компьютеры переходят в спящий режим, а в этом случае выполнение запланированного обновления невозможно.

После установки шлюза устанавливать другой его экземпляр не нужно. Один шлюз будет работать для любого числа поддерживаемых наборов данных. Шлюз не нужно устанавливать на том компьютере, с которого происходит передача книг и файлов Power BI Desktop. Вот пример. Предположим, что у вас есть книга Excel, которая подключается к источнику данных SQL Server в вашей организации. Вы отправили книгу с ноутбука с помощью функции получения данных в Power BI. У вас также имеется настольный компьютер, который постоянно работает. На этом компьютере установлен и настроен шлюз. В службе Power BI вы вошли в источники данных и настроили расписание обновления для набора данных.  При наступлении времени запланированного обновления Power BI выполняет безопасное подключения к шлюзу, установленному на компьютере. Затем осуществляется безопасное подключение к источникам данных для получения обновлений. Для обновления связь с исходной книгой, отправленной с ноутбука, отсутствует.

> [!NOTE]
> Личный и корпоративный шлюзы можно установить на один и тот же компьютер.
> 
> 

### <a name="windows-account"></a>Учетная запись Windows
При установке шлюза выполняется вход в систему компьютера с помощью учетной записи Windows. Тип разрешений учетной записи Windows будет оказывать влияние на способ установки и запуска шлюза в Windows.

Если вы выполнили вход в Windows:

|  | С разрешениями администратора | Без разрешений администратора |
| --- | --- | --- |
| **Шлюз Power BI Gateway — Personal запускается как** |Служба |Приложение |
| **Запланированные обновления** |Пока работают компьютер и служба шлюза, нет необходимости входить в систему во время запланированного обновления. |Необходимо войти на компьютер во время запланированного обновления. |
| **Изменение пароля учетной записи Windows** |Необходимо изменить пароль в службе шлюза. Если пароль учетной записи, используемый шлюзом, будет недействителен, обновление не будет выполнено. |Шлюз всегда будет работать с теми учетной записью и паролем, которые были указаны при входе в систему. Если вы не вошли в Windows, шлюз не будет запущен и обновление завершится ошибкой. | |

### <a name="configure-the-gateway"></a>Настройка шлюза
По завершении работы мастера установки вам будет предложено запустить мастер настройки. Для настройки шлюза требуется выполнить лишь несколько действий. Нужно выполнить вход в Power BI из мастера. Это необходимо, чтобы мастер установил соединение с учетной записью Power BI в службе Power BI.

Если вы выполнили вход в Windows с учетной записью с правами администратора, вам будет предложено ввести свои учетные данные учетной записи Windows. Можно указать другую учетную запись Windows, но помните, что способ запуска шлюза определяется разрешениями. Служба шлюза будет запущена с помощью этой учетной записи.

### <a name="sign-in-to-data-sources"></a>Вход в источники данных
После завершения работы мастера настройки и запуска шлюза необходимо указать тип аутентификации и войти в каждый источник данных набора данных. Это действие выполняется в Power BI.

![](media/personal-gateway/pg_dataset_settings_signin.png)

Необходимо только указать тип проверки подлинности и один раз войти в источник данных. Вход выполняется из раздела **Управление источниками данных** на экране "Параметры" набора данных. При наличии нескольких источников данных необходимо войти в каждый из них. Шлюз определяет тип аутентификации по умолчанию в зависимости от источника данных. В большинстве случаев это проверка подлинности Windows. Однако в некоторых случаях для источника данных может потребоваться другой тип проверки подлинности. Если вы не уверены в выборе, обратитесь к администратору источников данных.

## <a name="up-and-running"></a>Запущен и работает!
Если шлюз запущен и работает, можно щелкнуть "РАСПИСАНИЕ ОБНОВЛЕНИЙ" для набора данных, после чего вы увидите страницу его параметров.

![](media/personal-gateway/pg_awintsales_settings.png)

На этой странице отображаются следующие компоненты.

1. Состояние обновления. Отображение успеха обновления и времени следующего запланированного обновления.
2. **Шлюз**. Отображает информацию о том, установлен ли шлюз и доступен ли он в сети. Если шлюз установлен, но не находится в сети, параметры "Управление источниками данных" и "Расписание обновлений" отключены.
3. **Управление источниками данных**. Отображает источники данных, к которым подключается набор данных. Можно выполнить вход или изменить тип проверки подлинности. Войти в каждый источник данных нужно только один раз.
4. **Расписание обновлений**. Здесь можно настроить параметры расписания обновлений. Если шлюз находится не в сети, эти параметры будут отключены.
5. Уведомления об ошибках обновления. Этот выбранный по умолчанию параметр отправляет сообщение электронной почты в случае сбоя запланированного обновления.

## <a name="updating-your-windows-account-password"></a>Обновление пароля учетной записи Windows
Если при установке шлюза вы вошли в систему с учетной записью Windows с правами администратора, шлюз запускается как служба с помощью учетной записи Windows, указанной в мастере настройки. Чаще всего это будет та же учетная запись Windows, что и для входа в систему компьютера. При изменении пароля учетной записи Windows его также потребуется изменить в шлюзе, в противном случае служба может не запуститься, а обновление завершится ошибкой. Чтобы изменить пароль учетной записи Windows для шлюза, выберите личный шлюз на панели задач рабочего стола Windows или в приложениях.

![](media/personal-gateway/pg_programicon.png)

Здесь можно обновить пароль и проверить состояние подключения шлюза.

![](media/personal-gateway/pg_credentials.png)

## <a name="ports"></a>Порты
Связь осуществляется через исходящие порты TCP 443 (по умолчанию), 5671, 5672, 9350–9354.  Шлюзу не требуются входящие порты.

| Имена доменов | Исходящие порты | Описание |
| --- | --- | --- |
| *.powerbi.com |443 |HTTPS |
| *.analysis.windows.net |443 |HTTPS |
| *.login.windows.net |443 |HTTPS |
| *.servicebus.windows.net |5671-5672 |Расширенный протокол управления очередью сообщений (AMQP) |
| *.servicebus.windows.net |443, 9350-9354 |Прослушиватели для ретранслятора служебной шины по протоколу TCP (порт 443 требуется для получения маркера контроля доступа). |
| *.frontend.clouddatahub.net |443 |HTTPS |
| *.core.windows.net |443 |HTTPS |
| login.microsoftonline.com |443 |HTTPS |
| login.windows.net |443 |HTTPS |

Если вместо списка доменов требуется список разрешенных IP-адресов, можно скачать и использовать список диапазонов IP-адресов центра обработки данных Microsoft Azure. [Скачать](https://www.microsoft.com/download/details.aspx?id=41653)

## <a name="next-steps"></a>Дальнейшие действия
[Локальный шлюз данных (персональный режим) — новая версия личного шлюза](service-gateway-personal-mode.md);
[Настройка параметров прокси-сервера для Power BI Gateway](service-gateway-proxy.md).  
[Power BI Premium](service-premium.md)

Появились дополнительные вопросы? [Попробуйте задать вопрос в сообществе Power BI.](http://community.powerbi.com/)

